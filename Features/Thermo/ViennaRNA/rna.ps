%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.0.7
%%CreationDate: Thu Feb 28 17:03:24 2019
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
CGAGCUCAAGCCAGUCUCGCAGUAACGCUCAUCAGCUAACGAAAGAGUUAGAGGCUCGCUAAAUCGCACUGUCGGGGUCCCUUGGGUAUUUUACACUAGCGUCAGGUAGGCUAGCAUGUGUCUUUCCUUCCAGGGGUAUGCGGGUGCGUGGACAAAUGAGCAGCAUACGUAUUUACUCGGCGUGCUUGGUCUCUCGUAUU\
) def
/coor [
[112.15479279 484.16146851]
[111.21761322 469.19076538]
[110.28044128 454.22006226]
[109.34326172 439.24938965]
[97.49417877 423.97503662]
[106.71767426 406.05642700]
[105.31304932 391.12231445]
[103.90842438 376.18823242]
[102.50380707 361.25415039]
[101.09918213 346.32006836]
[99.69455719 331.38595581]
[88.09445953 322.11380005]
[86.45722961 306.98852539]
[96.26139069 294.88412476]
[94.85676575 279.95004272]
[91.80869293 276.26376343]
[91.04925537 270.62142944]
[93.64911652 264.52838135]
[92.71193695 249.55767822]
[89.15357971 243.07307434]
[91.87896729 234.34602356]
[91.17588043 219.36250305]
[90.47279358 204.37899780]
[89.76971436 189.39547729]
[88.71556854 174.43257141]
[87.31094360 159.49847412]
[85.90632629 144.56439209]
[79.85943604 140.12759399]
[73.93231964 153.90690613]
[69.80213165 168.32708740]
[55.60879135 173.17980957]
[43.51461411 164.30676270]
[43.88315201 149.31129456]
[56.40003204 141.04292297]
[67.76565552 131.25401306]
[61.71876526 126.81722260]
[47.05144119 129.95883179]
[32.38412094 133.10043335]
[17.71679878 136.24203491]
[3.04947734 139.38363647]
[-5.32593679 152.78617859]
[-20.74384880 156.25942993]
[-34.05708694 147.74278259]
[-37.36714172 132.28901672]
[-28.71021652 119.06655884]
[-13.22231197 115.92008209]
[-0.09212663 124.71631622]
[14.57519531 121.57471466]
[29.24251747 118.43310547]
[43.90983963 115.29150391]
[58.57715988 112.14990234]
[61.99493408 86.86112976]
[78.35938263 69.67317963]
[99.94445801 65.69956207]
[103.20058441 51.05723953]
[106.45671844 36.41491699]
[109.71284485 21.77259254]
[112.96897888 7.13027096]
[99.01271057 -2.33739448]
[89.78061676 -16.40666771]
[86.66392517 -32.90596390]
[90.11253357 -49.30154037]
[99.57034302 -63.08658981]
[113.56468201 -72.16452026]
[129.93556213 -75.16782379]
[132.73246765 -89.90476227]
[135.52937317 -104.64170074]
[138.32627869 -119.37863922]
[141.12316895 -134.11558533]
[143.92007446 -148.85252380]
[142.10038757 -155.22222900]
[143.55757141 -160.72581482]
[147.04158020 -164.00317383]
[150.29769897 -178.64549255]
[145.74058533 -193.79617310]
[156.05615234 -204.54039001]
[147.83811951 -217.77297974]
[151.34887695 -232.57598877]
[164.01478577 -240.32908630]
[167.27090454 -254.97142029]
[170.52703857 -269.61373901]
[173.78317261 -284.25607300]
[177.03930664 -298.89837646]
[180.29544067 -313.54071045]
[183.55155945 -328.18304443]
[186.80769348 -342.82534790]
[172.40670776 -353.54135132]
[164.16424561 -369.42797852]
[163.69813538 -387.26651001]
[171.05589294 -403.46551514]
[184.71453857 -414.78384399]
[201.89553833 -418.97915649]
[204.46177673 -433.75799561]
[207.02799988 -448.53686523]
[209.59423828 -463.31570435]
[211.92918396 -478.13287354]
[214.03225708 -492.98471069]
[216.13533020 -507.83654785]
[218.23840332 -522.68835449]
[220.34147644 -537.54022217]
[208.59382629 -547.54003906]
[204.13926697 -562.31030273]
[208.39921570 -577.13781738]
[220.01435852 -587.29125977]
[235.27832031 -589.53063965]
[249.32044983 -583.14141846]
[257.65994263 -570.16235352]
[257.63568115 -554.73498535]
[249.25544739 -541.78222656]
[235.19331360 -535.43713379]
[233.09024048 -520.58532715]
[230.98716736 -505.73345947]
[228.88409424 -490.88162231]
[226.78102112 -476.02978516]
[228.88935852 -471.73629761]
[228.31727600 -466.07186890]
[224.37309265 -460.74948120]
[221.80685425 -445.97064209]
[219.24063110 -431.19177246]
[216.67439270 -416.41293335]
[227.34262085 -410.39910889]
[235.66575623 -401.38232422]
[240.82873535 -390.22341919]
[242.31921387 -377.99404907]
[239.97830200 -365.87371826]
[234.01736450 -355.03607178]
[224.99909973 -346.53530884]
[213.78436279 -341.20349121]
[201.45001221 -339.56921387]
[198.19389343 -324.92691040]
[194.93775940 -310.28457642]
[191.68162537 -295.64224243]
[188.42549133 -280.99993896]
[185.16935730 -266.35760498]
[181.91323853 -251.71528625]
[178.65710449 -237.07296753]
[186.84356689 -224.68275452]
[183.74998474 -209.78697205]
[170.69848633 -201.28425598]
[175.48851013 -187.18089294]
[164.94003296 -175.38935852]
[161.68389893 -160.74703979]
[158.65701294 -146.05561829]
[155.86010742 -131.31867981]
[153.06321716 -116.58174133]
[150.26631165 -101.84480286]
[147.46940613 -87.10786438]
[144.67250061 -72.37092590]
[156.21002197 -65.82089996]
[165.18159485 -56.01612854]
[170.70281982 -43.90230179]
[172.22305298 -30.65372276]
[169.58023071 -17.55945778]
[163.01803589 -5.89792538]
[153.16352844 3.18792057]
[140.96717834 8.80261135]
[127.61129761 10.38640118]
[124.35517120 25.02872467]
[121.09903717 39.67104721]
[117.84291077 54.31336975]
[114.58677673 68.95568848]
[126.06594849 75.80089569]
[134.40745544 86.85182953]
[138.09446716 100.69563293]
[136.23654175 115.38577271]
[128.75024414 128.71545410]
[116.42263794 138.54873657]
[100.84041595 143.15975952]
[102.24503326 158.09385681]
[103.64965820 173.02793884]
[106.68290710 177.29588318]
[107.67129517 181.84553528]
[106.85099792 185.84889221]
[104.75322723 188.69239807]
[105.45630646 203.67591858]
[106.15939331 218.65942383]
[106.86248016 233.64294434]
[107.68263245 248.62049866]
[108.61981201 263.59118652]
[109.79085541 278.54541016]
[111.19548035 293.47949219]
[123.08467865 303.54351807]
[124.29642487 318.70883179]
[114.62864685 329.98135376]
[116.03327179 344.91543579]
[117.43789673 359.84951782]
[118.84251404 374.78359985]
[120.24713898 389.71771240]
[121.65176392 404.65179443]
[130.42402649 411.09988403]
[134.11904907 421.10699463]
[131.74189758 431.28079224]
[124.31395721 438.31219482]
[125.25112915 453.28289795]
[126.18830872 468.25360107]
[127.12548828 483.22427368]
[138.15660095 494.87304688]
[135.78442383 510.73977661]
[121.82866669 518.65283203]
[106.99500275 512.54199219]
] def
/pairs [
[1 196]
[2 195]
[3 194]
[4 193]
[6 189]
[7 188]
[8 187]
[9 186]
[10 185]
[11 184]
[14 181]
[15 180]
[18 179]
[19 178]
[21 177]
[22 176]
[23 175]
[24 174]
[25 170]
[26 169]
[27 168]
[36 51]
[37 50]
[38 49]
[39 48]
[40 47]
[54 161]
[55 160]
[56 159]
[57 158]
[58 157]
[65 148]
[66 147]
[67 146]
[68 145]
[69 144]
[70 143]
[73 142]
[74 141]
[76 139]
[79 136]
[80 135]
[81 134]
[82 133]
[83 132]
[84 131]
[85 130]
[86 129]
[92 120]
[93 119]
[94 118]
[95 117]
[96 114]
[97 113]
[98 112]
[99 111]
[100 110]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
